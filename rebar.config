{require_min_otp_vsn, "20.0"}.

{erl_opts, [debug_info, warn_unused_vars, warn_shadow_vars, warn_unused_import,
  warnings_as_errors, {parse_transform, lager_transform},
  {platform_define, "^(R|1|20)", 'FUN_STACKTRACE'},
  {lager_extra_sinks, [req_logs]}]}.

{deps, [
  {lager, {git, "https://github.com/erlang-lager/lager", {branch, "master"}}},
  {'cowboy', {
    git, "https://github.com/ninenines/cowboy.git", {branch, "master"}}},

  %% csv generator
  %% use jiffy as well
  {jiffy, {git, "https://github.com/davisp/jiffy.git", {branch, "master"}}},
  %% debug tools
  recon,
  %% testing
  proper,
  %% meck,
  %% metrics
  {ranch, {git, "https://github.com/ninenines/ranch.git", {branch, "master"}}},

  {bear, {
    git, "https://github.com/boundary/bear.git", {branch, "master"}}},
  %% dynamic gen_server pool
  %% a data driven data structure manipulation library for erlang.
  %% Conveniently manipulate Erlang maps
  {dotto, {
    git, "https://github.com/marianoguerra/dotto", {branch, "master"}}},
  {nested, {git, "https://github.com/odo/nested.git", {branch, "master"}}},
  %% redis client
  {eredis, {git, "https://github.com/wooga/eredis.git", {branch, "master"}}},
  {xxhash, {git, "https://github.com/pierreis/erlang-xxhash", {branch, "master"}}},
  %% mysql client
  {mysql, {git, "https://github.com/mysql-otp/mysql-otp.git", {branch, "master"}}},
  {erlsom, {git, "https://github.com/willemdj/erlsom", {branch, "master"}}},
  %% latch on to opentracing
  {otter, {git, "https://github.com/Bluehouse-Technology/otter", {branch, "master"}}},
  %% alarm manager (more functionality than Erlang alarm manager).
  {elarm, {git, "https://github.com/esl/elarm", {branch, "master"}}},

  %% circuit breaker
  {fuse, {git, "https://github.com/jlouis/fuse", {branch, "master"}}},

  %% blazingly fast hash
  %% original: https://github.com/pierreis/erlang-xxhash
  %%{xxhash, {git, "https://github.com/pierreis/erlang-xxhash", {branch, "master"}}},
  %% raven for sentry
  {raven_erlang, {git, "https://github.com/artemeff/raven-erlang", {branch, "master"}}},
%%  {crc32cer, {git, "https://github.com/zmstone/crc32cer.git", {branch, "master"}}},
%%  kafka client for erlang
  {brod, "3.15.1"}
]}.

{edoc_opts, [
  {new, true},
  {source_path, ["src/", "include/", "models/", "handlers/"]}
]}.

{profiles, [
  {prod, [
    [{relx, [
      {dev_mode, false},
      {include_src, false},
      {include_erts, true}
    ]}]
  ]},

  {test, [
    {deps, [proper]}
  ]}
]}.

{alias, [
  {check, [xrref, dialyzer, {proper, "-c"}, {cover, "-v"}]}
]}.


%% property based testing
%% IMPORTANT: Do not set to a very high value unless you know what you are doing
{proper_opts, [{numtests, 2}, {sys_config, "config/sys.config"}]}.

{relx, [
  {release, {ananta, "0.1.0"},
    [ananta]},

  %% _build/rel/myrel/lib are symlinks to _build/lib
  {dev_mode, true},
  %% Do not include Erlang runtime system and use system default
  {include_erts, false},
  %% provides a few more ways of starting and connecting to your release
  {extended_start_script, true},

  {sys_config, "config/sys.config"},
  {vm_args, "config/vm.args"}
]}.

{plugins, [
  rebar_alias,
  rebar3_proper
]}.


{xref_checks, [
  undefined_function_calls,undefined_functions,locals_not_used,
  exports_not_used,deprecated_function_calls, deprecated_functions
]}.

%% Paths for structure
{src_dirs, ["include", "src", "models", "handlers"]}.


%% -*- mode: erlang;erlang-indent-level: 4;indent-tabs-mode: nil -*-
%% ex: ts=4 sw=4 ft=erlang et
